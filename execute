Sub execute()
'
' execute Macro
'条件表をcsvファイルとして出力する
'「実行」押して最初意実行するマクロ

Dim i As Integer, j As Integer, ind As Integer
Dim members As Integer, days As Integer, skills As Integer
Dim name As String

members = Range("C2").Value
days = Range("C3").Value
skills = Range("C4").Value


Worksheets(3).Cells.Clear
        
Worksheets(3).Cells(1, 1).Value = Range("C2")
Worksheets(3).Cells(1, 2).Value = Range("C3")
Worksheets(3).Cells(1, 3).Value = Range("C4")


For i = 0 To members - 1
    For j = 0 To skills - 1
        ind = i * skills + j
        Worksheets(3).Cells(2, ind + 1).Value = Cells(7 + i, 3 + j)
    Next j
Next i

For i = 0 To members - 1
    For j = 0 To days - 1
        ind = j * members + i
        Worksheets(3).Cells(3, ind + 1).Value = Cells(7 + i, skills + 5 + j)
    Next j
Next i

For i = 0 To days - 1
    For j = 0 To skills - 1
        ind = i * skills + j
        Worksheets(3).Cells(4, ind + 1).Value = Cells(7 + i, skills + days + 7 + j)
    Next j
Next i

For i = 1 To days * members
    Worksheets("params").Cells(3, i).Value = Worksheets("params").Cells(3, i) - 1
    If Worksheets("params").Cells(3, i) < 0 Then
        Worksheets("params").Cells(3, i).Value = -1 * Worksheets("params").Cells(3, i)
    End If
Next
Application.DisplayAlerts = False
    
Worksheets(3).Copy
stamp = Format(Now, "mmdd_hhmm")
ActiveWorkbook.SaveAs FileName:="C:\Users\watanabe.kevin\Desktop\params\prm" + stamp + ".csv", _
    FileFormat:=xlCSV
ActiveWindow.Close
    
Application.DisplayAlerts = True
'
End Sub
